var w=(b,e,p)=>new Promise((r,o)=>{var i=d=>{try{f(p.next(d))}catch(C){o(C)}},z=d=>{try{f(p.throw(d))}catch(C){o(C)}},f=d=>d.done?r(d.value):Promise.resolve(d.value).then(i,z);f((p=p.apply(b,e)).next())});import{_ as R,a as P,b as ce,c as fe,d as de,e as ve,f as be,g as pe,h as xe,i as H,j as he,L as _e,k as ge,l as ye,u as we}from"./Attach.c7b780b8.js";import{p as ke,r as n,q as Se,i as g,v as I,_ as v,h as Ce,o as s,b as c,d as l,e as m,u as a,x as h,t as _,l as T,F as De,y as $e,z as y,A as Ae,w as j,T as Te,D as q,m as S,f as F,B as ze,C as Ve,E as Ee,G as Ie,H as Be}from"./index.0e3c50f7.js";import{U as Le}from"./User.861bcd1c.js";import"./FileUploader.a62e684a.js";const Ne=b=>(Ve("data-v-421a7deb"),b=b(),Ee(),b),je={class:"w-full sm:w-96 bg-white flex justify-center h-screen"},qe={class:"w-full flex flex-col"},Fe={class:"w-full sm:w-96 bg-white h-16 shadow-lg fixed top-0 z-10"},Ue={class:"pr-2 flex pt-3 items-center"},Re={class:"font-semibold w-fit text-xl pr-2"},Pe={key:0,class:"pt-1 b-2 text-xs font-light text-gray-600"},He={key:0},Me={key:1},Oe={class:"w-full flex justify-end"},We={class:"p-1 pr-4"},Ge={class:"flex-1 overflow-y-auto custom-scrollbar pt-20 pb-14 p-2 bg-gray-100"},Je={class:"bg-white rounded-lg"},Ke={key:0,class:"fixed bottom-0 left-0 w-full sm:w-96 h-1/4 bg-white p-4 rounded-t-lg border-t-[0.5px] border-gray-300"},Qe={class:"text-gray-600 p-2 text-[15px]"},Xe=Ne(()=>l("div",{class:"w-full border-b-[0.5px] border-gray-300 flex text-center justify-center touchable hover:cursor-pointer"},[l("p",{class:"text-gray-600 p-2 text-[15px]"},"Help")],-1)),Ye={class:"flex w-full sm:w-96 pl-3 pb-1 pt-1 fixed bottom-0 z-10 bg-white justify-center shadow-lg"},Ze={class:"pt-1 w-[20rem] sm:w-[20rem] ml-3"},et={key:0},tt={key:1},lt={key:3,class:"fixed bottom-[4rem] leading-5 pr-[65rem] pl-[2.5rem] z-50 w-full sm:w-96 animate-slide-in"},st={class:"rounded w-[20rem] h-fit p-2 text-left bg-blue-200 text-blue-500"},at={class:"rounded w-[20rem] h-fit p-2 text-left bg-red-200 text-red-500"},rt={class:"p-2 pr-2 pt-[5px]"},nt={__name:"show_form_builder",props:{frm:Object,docname:String,frmname:String,doctype:String},setup(b){const e=b,p={Data:R,Select:P,Int:ce,Autocomplete:fe,Dynamic_Link:P,Heading:de,Datetime:ve,Date:be,"Section Break":pe,Check:xe,Text:R,"Long Text":H,"Small Text":H,Float:he,Link:_e,Currency:ge,Attach:ye},r=n(!1),o=n(""),i=n(!1),z=n(e.frm.submitable),f=n(e.docname),d=n(e.frm.Docstatus),C=n({}),M=n(e.frm.Saved),O=n(e.frm.Submit),k=n(!1),D=n(!1),$=n(!1),W=n(e.frm.Amend),A=n(""),B=n(""),V=n(!1),L=n(!1),G=()=>{V.value=!V.value};Se(e.frm,t=>{d.value=t.Docstatus,M.value=t.Saved,O.value=t.Submit,z.value=t.submitable,W.value=t.Amend,t.action?L.value=!1:L.value=!0});const J=()=>{e.frm.workflow(),V.value=!1};e.frm.name=e.docname,e.frm.doctype=e.doctype,e.frm.Frm=e.frmname;const K=()=>w(this,null,function*(){r.value=!0,z.value=e.frm.submitable;try{yield e.frm.update(),o.value="Updated successful!",i.value=!0,C.value=e.frm.doc,e.frm.workflow}catch(t){o.value=`Error: ${t.message}`,i.value=!1,console.error(`Error: ${t.message}`)}finally{r.value=!1,setTimeout(()=>{o.value=""},2500)}}),Q=()=>w(this,null,function*(){r.value=!0;try{const t=yield e.frm.amend();f.value=t,o.value="Amend successful!",i.value=!0,N.push({path:"/showform",query:{docname:t}})}catch(t){o.value=`Error: ${t.message}`,i.value=!1,console.error(`Error: ${t.message}`)}finally{r.value=!1,setTimeout(()=>{o.value=""},2500)}}),X=()=>w(this,null,function*(){r.value=!0;try{d.value=yield e.frm.submit(f.value),o.value="Submit successful!",i.value=!0,d.value=1,k.value=!1}catch(t){o.value=`Error: ${t.message}`,i.value=!1,console.error(`Error: ${t.message}`),k.value=!1}finally{r.value=!1,setTimeout(()=>{o.value=""},2500)}}),Y=()=>w(this,null,function*(){$.value=!1;try{yield e.frm.cancel(f.value),A.value="Cancel successful!",B.value=!0}catch(t){A.value=`Error: ${t.message}`,B.value=!1,console.error(`Error: ${t.message}`)}finally{r.value=!1,setTimeout(()=>{A.value=""},2500)}}),Z=()=>{k.value=!0},ee=()=>{D.value=!0},te=()=>{$.value=!0},le=g(()=>{const t=[];let x=0;for(const u of e.frm.fields)u.fieldtype==="Section Break"?(x+=1,t.push(u)):x===0&&t.push(u);return t}),se=g(()=>e.frm.style=="Success"?"bg-green-200 h-[2rem] rounded-2xl text-center":e.frm.style=="Danger"?"bg-red-200 h-[2rem] rounded-2xl text-center":e.frm.style=="Inverse"?"bg-black h-[2rem] rounded-2xl text-center":e.frm.style=="Warning"?"bg-orange-200 h-[2rem] rounded-2xl text-center":e.frm.style=="Info"?"bg-blue-200 h-[2rem] rounded-2xl text-center":e.frm.style=="Primary"?"bg-[#9fa8da] h-[2rem] rounded-2xl text-center":"bg-gray-200 h-[2rem] rounded-2xl text-center"),ae=g(()=>e.frm.style=="Success"?"p-2 text-sm w-20 text-green-500":e.frm.style=="Danger"?"p-2 text-sm w-20 text-red-500":e.frm.style=="Inverse"?"p-2 text-sm w-20 text-white":e.frm.style=="Warning"?"p-2 text-sm w-20 text-orange-500":e.frm.style=="Info"?"p-2 text-sm w-20 text-blue-500":e.frm.style=="Primary"?"p-2 text-sm w-20 text-[#1a237e]":"p-2 text-sm w-20 text-gray-500"),re=g(()=>{if(e.frm.submitable==0)return"";if(e.frm.Saved===0)return"Not Saved";if(e.frm.Saved===1)return e.frm.submitable===1&&e.frm.Submit!==1?"Draft":e.frm.Docstatus===2?"Cancelled":e.frm.Submit===1?"Submitted":"Saved"}),ne=g(()=>{if(e.frm.submitable==0)return"";if(e.frm.Saved===0)return"bg-red-200 h-[2rem] rounded-2xl text-center";if(e.frm.Saved===1)return e.frm.submitable===1&&e.frm.Submit!==1?"bg-red-200 h-[2rem] rounded-2xl text-center":e.frm.Docstatus===2?"bg-red-200 rounded-2xl text-center":(e.frm.Submit===1,"bg-blue-200 h-[2rem] rounded-2xl text-center")}),oe=g(()=>{if(e.frm.submitable==0)return"";if(e.frm.Saved===0)return"p-2 text-sm w-20 text-red-500";if(e.frm.Saved===1)return e.frm.submitable===1&&e.frm.Submit!==1||e.frm.Docstatus===2?"p-2 text-sm w-20 text-red-500":(e.frm.Submit===1,"p-2 text-sm w-20 text-blue-500")}),E=n(""),ie=()=>w(this,null,function*(){f.value&&(E.value=yield e.frm.delete(f.value),setTimeout(()=>{E.value=""},2500),D.value=!1,U())}),ue=g(()=>{const t=[{label:"Print",icon:()=>I(v,{name:"printer"})},{label:"Create New "+e.frm.doctype,icon:()=>I(v,{name:"file-plus"}),onClick:()=>{me()}},{label:"Reload",icon:()=>I(v,{name:"refresh-ccw"}),onClick:()=>{window.location.reload()}}];return e.frm.Docstatus!==1&&t.push({label:"Delete",icon:()=>I(v,{name:"trash"}),onClick:ee}),[{group:"Actions",items:t}]}),N=Ce(),U=()=>{e.frm.doc={docstatus:0},e.frm.name=null,e.frm.fields=[],e.frm.Docstatus=0,e.frm.Saved=0,e.frm.Submit=0,e.frm.Amend=0,N.push({name:"ListPage",query:{frmname:e.frm.Frm,doctype:e.frm.doctype}})},me=()=>{e.frm.doc={docstatus:0},e.frm.name=null,e.frm.fields=[],e.frm.Docstatus=0,e.frm.Saved=0,e.frm.Submit=0,e.frm.Amend=0,N.push({name:"Form",query:{frmname:e.frm.Frm,doctype:e.frm.doctype}})};return(t,x)=>(s(),c("div",je,[l("div",qe,[l("div",Fe,[l("div",Ue,[m(a(v),{class:"w-8 h-8 text-gray-600 hover:text-black",name:"chevron-left",onClick:U}),l("div",{class:h({"flex-1 text-center":!f.value})},[l("p",Re,_(b.frm.doctype),1),f.value?(s(),c("p",Pe,_(f.value),1)):T("",!0)],2),e.frm.workflowStatus?(s(),c("div",He,[l("div",{class:h(se.value)},[l("p",{class:h(ae.value)},_(e.frm.workflow_state),3)],2)])):(s(),c("div",Me,[l("div",{class:h(ne.value)},[l("p",{class:h(oe.value)},_(re.value),3)],2)])),l("div",Oe,[l("div",We,[m(a(v),{class:"w-6 h-6 text-gray-600 hover:text-black",name:"bell"})]),m(Le)])])]),l("div",Ge,[l("div",Je,[(s(!0),c(De,null,$e(le.value,u=>(s(),y(Ae(p[u.fieldtype]),{key:u.fieldname,para:"",should:"",align:"",perfectly:"",field:u,frm:b.frm},null,8,["field","frm"]))),128))])]),m(Te,{name:"slide-up"},{default:j(()=>[V.value?(s(),c("div",Ke,[l("div",null,[l("div",{class:"w-full border-b-[0.5px] border-gray-300 flex text-center justify-center touchable hover:cursor-pointer",onClick:J},[l("p",Qe,_(e.frm.action),1)]),Xe])])):T("",!0)]),_:1}),l("div",Ye,[m(a(q),{options:{title:"Confirm",message:"Are you sure you want to submit this form "+e.docname+"?",size:"sm",actions:[{label:"Confirm",variant:"solid",onClick:X},{label:"Cancel",variant:"subtle",onClick:()=>{k.value=!1}}]},modelValue:k.value,"onUpdate:modelValue":x[0]||(x[0]=u=>k.value=u)},null,8,["options","modelValue"]),m(a(q),{options:{title:"Confirm Delete",message:"Are you sure you want to delete this form "+e.docname+"?",size:"sm",actions:[{label:"Delete",variant:"solid",onClick:ie},{label:"Cancel",variant:"subtle",onClick:()=>{D.value=!1}}]},modelValue:D.value,"onUpdate:modelValue":x[1]||(x[1]=u=>D.value=u)},null,8,["options","modelValue"]),m(a(q),{options:{title:"Confirm Cancel",message:"Are you sure you want to cancel this form "+e.docname+"?",size:"sm",actions:[{label:"Confirm",variant:"solid",onClick:Y},{label:"Cancel",variant:"subtle",onClick:()=>{$.value=!1}}]},modelValue:$.value,"onUpdate:modelValue":x[2]||(x[2]=u=>$.value=u)},null,8,["options","modelValue"]),l("div",Ze,[e.frm.workflowStatus?(s(),c("div",et,[m(a(S),{variant:"solid",theme:"gray",size:"sm",label:"Action",loading:r.value,loadingText:"Saving...",disabled:L.value,link:null,class:"w-full h-full p-2",onClick:G},null,8,["loading","disabled"])])):(s(),c("div",tt,[e.frm.Saved==0||e.frm.submitable==0?(s(),y(a(S),{key:0,variant:"solid",theme:"gray",size:"sm",label:"Save",loading:r.value,loadingText:"Saving...",disabled:e.frm.saved,link:null,class:"w-full h-full p-2",onClick:K},null,8,["loading","disabled"])):e.frm.Docstatus===1&&e.frm.Saved==1&&e.frm.submitable==1?(s(),y(a(S),{key:1,variant:"solid",theme:"red",size:"sm",label:"Cancel",loading:r.value,loadingText:"Cancelling...",disabled:!1,link:null,class:"w-full h-full p-2",onClick:te},null,8,["loading"])):e.frm.Docstatus==2&&e.frm.submitable==1?(s(),y(a(S),{key:2,variant:"solid",theme:"gray",size:"sm",label:"Amend",loading:r.value,loadingText:"Amending...",disabled:!1,link:null,class:"w-full h-full p-2",onClick:Q},null,8,["loading"])):(s(),y(a(S),{key:3,variant:"solid",theme:"gray",size:"sm",label:"Submit",loading:r.value,loadingText:"Submitting...",disabled:!1,link:null,class:"w-full h-full p-2",onClick:Z},null,8,["loading"]))])),o.value?(s(),c("div",{key:2,class:h(["fixed bottom-[4rem] leading-5 pr-[65rem] pl-[2.5rem] z-50 w-full sm:w-96",i.value?"animate-slide-in":"animate-slide-out"])},[l("div",{class:h(["rounded w-[20rem] h-fit p-2 text-left",{"bg-blue-200 text-blue-500":i.value,"bg-red-200 text-red-500":!i.value}])},[i.value?(s(),y(a(v),{key:0,name:"check",class:"inline w-4 h-4 mr-2"})):(s(),y(a(v),{key:1,name:"x",class:"inline w-4 h-4 mr-2"})),F(" "+_(o.value),1)],2)],2)):T("",!0),E.value?(s(),c("div",lt,[l("div",st,[m(a(v),{name:"info",class:"inline w-4 h-4 mr-2"}),F(" "+_(E.value),1)])])):T("",!0),A.value?(s(),c("div",{key:4,class:h(["fixed bottom-[4rem] leading-5 pr-[65rem] pl-[2.5rem] z-50 w-full sm:w-96",B.value?"animate-slide-in":"animate-slide-out"])},[l("div",at,[m(a(v),{name:"x",class:"inline w-4 h-4 mr-2"}),F(" "+_(A.value),1)])],2)):T("",!0)]),l("div",rt,[m(a(ze),{options:ue.value},{default:j(()=>[m(a(S),null,{icon:j(()=>[m(a(v),{name:"more-vertical",class:"h-6 w-6 text-gray-600 hover:text-black"})]),_:1})]),_:1},8,["options"])])])])]))}};var ot=ke(nt,[["__scopeId","data-v-421a7deb"]]);const it={class:"w-full flex-1 overflow-y-auto custom-scrollbar"},ut={key:1},bt={__name:"ShowForm",setup(b){const e=we(),p=g(()=>e.form),r=Ie();return Be(()=>w(this,null,function*(){yield e.initForm()})),(o,i)=>(s(),c("div",it,[p.value?(s(),y(ot,{key:0,docname:a(r).query.docname,frm:p.value,doctype:a(r).query.doctype,frmname:a(r).query.frmname},null,8,["docname","frm","doctype","frmname"])):(s(),c("p",ut,"Loading..."))]))}};export{bt as default};
