var b=(u,e,m)=>new Promise((n,o)=>{var c=i=>{try{v(m.next(i))}catch(s){o(s)}},w=i=>{try{v(m.throw(i))}catch(s){o(s)}},v=i=>i.done?n(i.value):Promise.resolve(i.value).then(c,w);v((m=m.apply(u,e)).next())});import{_ as F,a as z,b as G,c as J,d as K,e as Q,f as W,g as X,h as Y,i as B,j as Z,L as ee,k as te,l as ae,u as se}from"./Attach.c7b780b8.js";import{U as le}from"./User.861bcd1c.js";import{p as re,r as f,q as ne,i as g,v as T,_ as d,h as oe,o as r,b as x,d as a,e as p,u as l,t as S,x as k,F as ie,y as ce,z as h,A as ue,m as $,f as L,l as N,w as A,B as me,C as fe,E as de,G as ve,H as _e}from"./index.0e3c50f7.js";import"./FileUploader.a62e684a.js";const pe=u=>(fe("data-v-42ee0c4c"),u=u(),de(),u),he={class:"w-full sm:w-96 bg-white flex justify-center h-screen"},be={class:"w-full flex flex-col"},ge={class:"w-full sm:w-96 bg-white h-14 shadow-lg fixed top-0 z-10"},xe={class:"p-2 flex pt-3"},ye=pe(()=>a("div",null,null,-1)),we={class:"font-semibold w-fit text-xl pt-[8px] pr-2"},Se={class:"w-full flex justify-end"},ke={class:"p-1 pr-4"},$e={class:"flex-1 overflow-y-auto custom-scrollbar pt-20 pb-14 p-2 bg-gray-200"},Ce={class:"p-2 bg-white rounded-lg"},Te={class:"flex w-full sm:w-96 pb-1 pt-1 fixed bottom-0 z-10 bg-white shadow-lg justify-center"},De={class:"pt-1 w-[20rem] sm:w-[20rem] ml-3"},Fe={key:4,class:"fixed bottom-[4rem] leading-5 pr-[65rem] pl-[2.5rem] z-50 w-full sm:w-96 animate-slide-in"},ze={class:"rounded w-[20rem] h-fit p-2 text-left bg-blue-200 text-blue-500"},Be={class:"p-2 pr-2 pt-[5px]"},Le={__name:"form_builder",props:{frm:Object,doctype:String,frnname:String},setup(u){const e=u,m={Data:F,Select:z,Int:G,Autocomplete:J,Dynamic_Link:z,Heading:K,Datetime:Q,Date:W,"Section Break":X,Check:Y,Text:F,"Long Text":B,"Small Text":B,Float:Z,Link:ee,Currency:te,Attach:ae},n=f(!1),o=f(""),c=f(!1),w=f(0),v=f(!1),i=f(""),s=f(0),E=f({});e.frm.doctype=e.doctype,e.frm.Frm=e.frnname,ne(s,t=>{t===1&&(v.value=!1)});const j=()=>b(this,null,function*(){n.value=!0,w.value=e.frm.submitable;try{const t=yield e.frm.save();i.value=t,o.value="Save successful!",c.value=!0,w.value===1&&(v.value=!0),E.value=e.frm.doc,D.push({path:"/showform",query:{docname:t,frmname:e.frm.Frm,doctype:e.frm.doctype}})}catch(t){o.value=`Error: ${t.message}`,c.value=!1,console.error(`Error: ${t.message}`)}finally{n.value=!1,setTimeout(()=>{o.value=""},2500)}}),q=()=>b(this,null,function*(){n.value=!0;try{s.value=yield e.frm.submit(i.value),o.value="Submit successful!",c.value=!0}catch(t){o.value=`Error: ${t.message}`,c.value=!1,console.error(`Error: ${t.message}`)}finally{n.value=!1,setTimeout(()=>{o.value=""},2500)}}),I=()=>b(this,null,function*(){console.log(s.value)}),V=g(()=>{const t=[];let C=0;for(const _ of e.frm.fields)_.fieldtype==="Section Break"?(C+=1,t.push(_)):C===0&&t.push(_);return t}),M=g(()=>{if(e.frm.Saved===0)return"Not Saved";if(e.frm.Saved===1)return e.frm.submitable===1&&s.value!==1?"Draft":s.value===1?"Submitted":"Saved"}),R=g(()=>{if(e.frm.Saved===0)return"bg-red-200 h-[2rem] rounded-2xl text-center";if(e.frm.Saved===1)return e.frm.submitable===1&&s.value!==1?"bg-red-200 h-[2rem] rounded-2xl text-center":(s.value===1,"bg-green-200 h-[2rem] rounded-2xl text-center")}),H=g(()=>{if(e.frm.Saved===0)return"p-2 text-sm w-20 text-red-500";if(e.frm.Saved===1)return e.frm.submitable===1&&s.value!==1?"p-2 text-sm w-20 text-red-500":(s.value===1,"p-2 text-sm w-20 text-green-500")}),y=f(""),O=()=>b(this,null,function*(){i.value&&(y.value=yield e.frm.delete(i.value),console.log(y.value),setTimeout(()=>{y.value=""},2500))}),P=g(()=>{const t=[{label:"Print",icon:()=>T(d,{name:"printer"})},{label:"Create New "+e.frm.doctype,icon:()=>T(d,{name:"file-plus"})}];return!v.value&&s.value!==1&&t.push({label:"Delete",icon:()=>T(d,{name:"trash"}),onClick:O}),[{group:"Actions",items:t}]}),D=oe(),U=()=>{e.frm.doc={docstatus:0},e.frm.name=null,e.frm.fields=[],e.frm.Docstatus=0,e.frm.Saved=0,e.frm.Submit=0,e.frm.Amend=0,D.push({name:"ListPage",query:{frmname:e.frm.Frm,doctype:e.frm.doctype}})};return(t,C)=>(r(),x("div",he,[a("div",be,[a("div",ge,[a("div",xe,[ye,p(l(d),{class:"w-8 h-8 text-gray-600 hover:text-black",name:"chevron-left",onClick:U}),a("p",we,S(u.frm.doctype),1),a("div",{class:k(R.value)},[a("p",{class:k(H.value)},S(M.value),3)],2),a("div",Se,[a("div",ke,[p(l(d),{class:"w-6 h-6 text-gray-600 hover:text-black",name:"bell"})]),p(le)])])]),a("div",$e,[a("div",Ce,[(r(!0),x(ie,null,ce(V.value,_=>(r(),h(ue(m[_.fieldtype]),{key:_.fieldname,field:_,frm:u.frm},null,8,["field","frm"]))),128))])]),a("div",Te,[a("div",De,[e.frm.Saved==0?(r(),h(l($),{key:0,variant:"solid",theme:"gray",size:"sm",label:"Save",loading:n.value,loadingText:"Saving...",disabled:!1,link:null,class:"w-full h-full p-2",onClick:j},null,8,["loading"])):s.value===1&&!v.value?(r(),h(l($),{key:1,variant:"outline",theme:"gray",size:"sm",label:"Cancel",loading:n.value,loadingText:"Cancelling...",disabled:!1,link:null,class:"w-full h-full p-2",onClick:I},null,8,["loading"])):(r(),h(l($),{key:2,variant:"solid",theme:"gray",size:"sm",label:"Submit",loading:n.value,loadingText:"Submitting...",disabled:!1,link:null,class:"w-full h-full p-2",onClick:q},null,8,["loading"])),o.value?(r(),x("div",{key:3,class:k(["fixed bottom-[4rem] leading-5 pr-[65rem] pl-[2.5rem] z-50 w-full sm:w-96",c.value?"animate-slide-in":"animate-slide-out"])},[a("div",{class:k(["rounded w-[20rem] h-fit p-2 text-left",{"bg-blue-200 text-blue-500":c.value,"bg-red-200 text-red-500":!c.value}])},[c.value?(r(),h(l(d),{key:0,name:"check",class:"inline w-4 h-4 mr-2"})):(r(),h(l(d),{key:1,name:"x",class:"inline w-4 h-4 mr-2"})),L(" "+S(o.value),1)],2)],2)):N("",!0),y.value?(r(),x("div",Fe,[a("div",ze,[p(l(d),{name:"info",class:"inline w-4 h-4 mr-2"}),L(" "+S(y.value),1)])])):N("",!0)]),a("div",Be,[p(l(me),{options:P.value},{default:A(()=>[p(l($),null,{icon:A(()=>[p(l(d),{name:"more-vertical",class:"h-6 w-6 text-gray-600 hover:text-black"})]),_:1})]),_:1},8,["options"])])])])]))}};var Ne=re(Le,[["__scopeId","data-v-42ee0c4c"]]);const Ae={class:"w-full flex-1 overflow-y-auto custom-scrollbar"},Ee={key:1},Re={__name:"Form",setup(u){const e=se(),m=g(()=>e.form),n=ve();return _e(()=>b(this,null,function*(){yield e.initForm()})),(o,c)=>(r(),x("div",Ae,[m.value?(r(),h(Ne,{key:0,frm:m.value,frnname:l(n).query.frmname,doctype:l(n).query.doctype},null,8,["frm","frnname","doctype"])):(r(),x("p",Ee,"Loading..."))]))}};export{Re as default};
